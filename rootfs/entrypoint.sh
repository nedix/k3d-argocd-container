#!/usr/bin/env sh

: ${K3S_VERSION}

# -------------------------------------------------------------------------------
#    Bootstrap K3S services
# -------------------------------------------------------------------------------
{
    # -------------------------------------------------------------------------------
    #    Create k3s-deploy environment
    # -------------------------------------------------------------------------------
    mkdir -p /run/k3s-deploy/environment

    echo "$K3S_VERSION" > /run/k3s-deploy/environment/K3S_VERSION
}

# -------------------------------------------------------------------------------
#    Liftoff!
# -------------------------------------------------------------------------------
exec env -i \
    S6_STAGE2_HOOK="/usr/sbin/s6-stage2-hook" \
    /init
